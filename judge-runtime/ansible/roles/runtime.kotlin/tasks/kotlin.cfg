name: "kotlin-runtime"
description: "Run as: sudo nsjail --config /etc/runtime/kotlin.cfg -- [cmd]"

hostname: "kotlin-runtime"
mode: ONCE

envar: "JAVA_HOME=/usr/java/jdk-21-oracle-x64/"
envar: "JVM_TMP=/tmp"
envar: "JAVA_OPTS="
envar: "LANG=en_US.UTF-8"
envar: "HOME=/user"
envar: "TMP=/tmp"

rlimit_as: 262144
rlimit_fsize: 1024
rlimit_cpu: 1
rlimit_cpu_type: INF
rlimit_nofile: 64

max_cpus: 2
time_limit: 10

use_cgroupv2: true
cgroup_pids_max: 30

uidmap {
	inside_id: "1010"
	outside_id: ""
	count: 1
}

gidmap {
	inside_id: "1010"
	outside_id: ""
	count: 1
}

mount_proc: false

mount {
	src_content: "nobody:x:1010:1010:nobody:/tmp:/bin/bash"
	dst: "/etc/passwd"
	mandatory: false
}

mount {
	src_content: "nogroup::1010:nogroup"
	dst: "/etc/group"
	mandatory: false
}

mount {
	dst: "/user"
	fstype: "tmpfs"
	rw: true
}

mount {
	dst: "/tmp"
	fstype: "tmpfs"
	rw: true
}

mount {
	src: "/bin"
	dst: "/bin"
	is_bind: true
	rw: false
}

mount {
	src: "/lib"
	dst: "/lib"
	is_bind: true
	rw: false
}

mount {
	src: "/lib64"
	dst: "/lib64"
	is_bind: true
	rw: false
}

mount {
	src: "/usr/bin"
	dst: "/usr/bin"
	is_bind: true
	rw: false
}

mount {
	src: "/usr/lib"
	dst: "/usr/lib"
	is_bind: true
	rw: false
}

mount {
	src: "/usr/local/kotlinc"
	dst: "/usr/local/kotlinc"
	is_bind: true
	rw: false
}

mount {
	src: "/etc/alternatives"
	dst: "/etc/alternatives"
	is_bind: true
	rw: false
}

mount {
	src: "/usr/java"
	dst: "/usr/java"
	is_bind: true
	rw: false
}

mount {
	dst: "/proc"
	fstype: "proc"
	rw: false
}

mount {
	src: "/dev/null"
	dst: "/dev/null"
	is_bind: true
	rw: true
}

mount {
	dst: "/dev/shm"
	fstype: "tmpfs"
	rw: true
	is_bind: false
}

mount {
	src: "/dev/urandom"
	dst: "/dev/urandom"
	is_bind: true
	rw: false
}

mount {
	src: "/dev/random"
	dst: "/dev/random"
	is_bind: true
	rw: false
}
